<div class="card">
  <div class="card-header">
    <i class="fa fa-align-justify"></i> Prestadores turísticos
    <div class="content-button-create d-flex">
      <button type="button" class="btn btn-pill btn-block btn-success" (click)="openModal(CreateProviders)">
        <i class="fa fa-plus"></i> Crear</button>
      <button type="button" class="btn btn-pill btn-block btn-success m-0" (click)="openModal(CreateProvidersMassive)">
        <i class="fa fa-plus"></i> Importar</button>
    </div>
  </div>
  <div class="card-body">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>
            <div class="input-group">
              <div class="input-group-prepend">
                <span class="input-group-text" id="inputGroup-sizing-default">Nombre</span>
              </div>
              <input #nameSearch type="text" class="form-control" placeholder="Busqueda por nombre" aria-label="Default" aria-describedby="inputGroup-sizing-default" [(ngModel)]="valueToSearch" (ngModelChange)="loadDaraFilterByName($event)">
            </div>
          </th>
          <th>
            <div class="btn-group" dropdown container="body">
              <button id="button-container" dropdownToggle type="button" class="btn btn-secondary dropdown-toggle"
                aria-controls="dropdown-container">
                <span>
                  Servicios
                </span>
                <span class="caret"></span>
              </button>
              <ul id="dropdown-container" *dropdownMenu class="dropdown-menu drop-down-filter" role="menu"
                aria-labelledby="button-container">
                <li role="menuitem" style="cursor:pointer">
                  <a class="dropdown-item" (click)="loadData()">Todos</a>
                  <a class="dropdown-item" *ngFor="let services of returnedArrayServices" (click)="loadDataFilterByServices(services.name)">{{services.name}}</a>
                </li>
              </ul>
            </div>
          </th>
          <th>
            <div class="btn-group" dropdown container="body">
              <button id="button-container" dropdownToggle type="button" class="btn btn-secondary dropdown-toggle"
                aria-controls="dropdown-container">
                <span>
                  Ciudad
                </span>
                <span class="caret"></span>
              </button>
              <ul id="dropdown-container" *dropdownMenu class="dropdown-menu drop-down-filter" role="menu"
                aria-labelledby="button-container">
                <li role="menuitem" style="cursor:pointer" >
                  <a class="dropdown-item" (click)="loadData()">Todos</a>
                  <a class="dropdown-item" *ngFor="let township of returnedArrayTownship" (click)="loadDataFilterByCity(township.name)">{{township.name}}</a>
                </li>
              </ul>
            </div>
          </th>
          <th>Celular</th>
          <th>Acciones</th> 
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let touristProvider of returnedArray">
          <td>{{touristProvider.name}}</td>
          <td>{{touristProvider.services}}</td>
          <td>{{touristProvider.township}}</td>
          <td>{{touristProvider.cellphone}}</td>
          <td>
            <div class="btn-group" dropdown container="body">
              <button id="button-container" dropdownToggle type="button" class="btn btn-primary dropdown-toggle"
                aria-controls="dropdown-container">
                <span>
                  Acciones
                </span>
                <span class="caret"></span>
              </button>
              <ul id="dropdown-container" *dropdownMenu class="dropdown-menu" role="menu"
                aria-labelledby="button-container">
                <li role="menuitem" style="cursor:pointer">
                  <a class="dropdown-item" (click)="openModal(CreateProviders, touristProvider)">Editar</a>
                </li>
                <li role="menuitem" style="cursor:pointer">
                  <a class="dropdown-item" (click)="openAlertDelete(AlertDelete, touristProvider.url_slug)">Eliminar</a>
                </li>
              </ul>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <div *ngIf="!results" class="noResultsMessage">
      <img src="../../../assets/icons/exclamation-diamond-fill.svg" height="30px">
      <p  class="text-center text-err">No hay resultados que coincidan con la busqueda</p>
    </div>
    <pagination [totalItems]="touristProvidersData.length" (pageChanged)="pageChanged($event)"
      [customPreviousTemplate]="prevTemplate" [customNextTemplate]="nextTemplate"></pagination>
    <ng-template #nextTemplate let-disabled="disabled" let-currentPage="currentPage">
      <ng-container *ngIf="!disabled">
        ➡️
      </ng-container>
      <ng-container *ngIf="disabled">
        ⛔
      </ng-container>
    </ng-template>
    <ng-template #prevTemplate let-disabled="disabled" let-currentPage="currentPage">
      <ng-container *ngIf="!disabled">
        ⬅️
      </ng-container>
      <ng-container *ngIf="disabled">
        ⛔
      </ng-container>
    </ng-template>
  </div>
</div>

<ng-template #CreateProviders>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Crear Prestador Turistico</h4>
    <button type="button" class="btn-close close pull-right" aria-label="Close" (click)="modalRef?.hide()">
      <span aria-hidden="true" class="visually-hidden">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <app-create-tourist-providers [modalType]="'createOrEdit'" [documentToEdit]="documentToEdit" (closeModal)="closeModal()"></app-create-tourist-providers>
  </div>
</ng-template>
<ng-template #AlertDelete>
    
  <div class="modal-header mh">
    <div class="text-center w-100">
      <h4 class="modal-title ">¿Esta seguro que desea eliminar? </h4>
    </div>
    <button type="button" class="btn-close close pull-right bx" aria-label="Close" (click)="modalRef?.hide()">
      <span aria-hidden="true" class="visually-hidden">&times;</span>
    </button>
  </div>
  <div class="modal-body d-flex justify-content-center">
    <button type="button" class="btn btn-pill btn-block btn-danger m-0 size"
      (click)="delete()"><i class="cil-trash"></i> Eliminar</button>
    <button type="button" class="btn btn-pill btn-block btn-success m-0 size "
    (click)="closeModal()" ><i class="cil-x-circle"></i> Cancelar</button>
  </div>
</ng-template>

<ng-template #CreateProvidersMassive>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Importar</h4>
    <button type="button" class="btn-close close pull-right" aria-label="Close" (click)="modalRef?.hide()">
      <span aria-hidden="true" class="visually-hidden">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <app-create-tourist-providers [modalType]="'createMassive'" (closeModal)="closeModal()">
    </app-create-tourist-providers>
  </div>
</ng-template>